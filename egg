-- Finalized Roblox Egg Refresher Script with black background, clear title, fixed dropdown, and full layout adjustments

local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local screenGui = Instance.new("ScreenGui", playerGui)
screenGui.ResetOnSpawn = false

local TweenService = game:GetService("TweenService")

local selectedEgg = nil
local detectCooldown = false

local petNames = {
    ["Bug Egg"] = "Snail",
    ["Night Egg"] = "Moon Cat",
    ["Anti-Bee Egg"] = "Wasp",
    ["Oasis Egg"] = "Sand Snake",
    ["Paradise Egg"] = "Capybara"
}

local scannedEggs = {}

local function makeDraggable(frame)
    frame.Active = true
    frame.Draggable = true
end

-- Start Frame
local startFrame = Instance.new("Frame", screenGui)
startFrame.Size = UDim2.new(0, 220, 0, 100)
startFrame.Position = UDim2.new(0.4, 0, 0.4, 0)
startFrame.BackgroundColor3 = Color3.new(0, 0, 0)
Instance.new("UICorner", startFrame)
makeDraggable(startFrame)

local startButton = Instance.new("TextButton", startFrame)
startButton.Size = UDim2.new(0.8, 0, 0.5, 0)
startButton.Position = UDim2.new(0.1, 0, 0.25, 0)
startButton.Text = "Start"
startButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
startButton.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", startButton)

local mainSquare = Instance.new("Frame", screenGui)
mainSquare.Size = UDim2.new(0, 250, 0, 250)
mainSquare.Position = UDim2.new(0.4, 0, 0.35, 0)
mainSquare.BackgroundColor3 = Color3.new(0, 0, 0)
mainSquare.Visible = false
Instance.new("UICorner", mainSquare)
makeDraggable(mainSquare)

startButton.MouseButton1Click:Connect(function()
    startFrame.Visible = false
    mainSquare.Visible = true
end)

-- Title
local titleLabel = Instance.new("TextLabel", mainSquare)
titleLabel.Size = UDim2.new(1, 0, 0.12, 0)
titleLabel.Position = UDim2.new(0, 0, 0.88, 0)
titleLabel.Text = "Egg Refresher - Modified by NO-lag script"
titleLabel.BackgroundTransparency = 1
titleLabel.TextColor3 = Color3.new(1, 1, 1)
titleLabel.Font = Enum.Font.GothamBold
titleLabel.TextScaled = true

-- Choose Egg Button
local eggButton = Instance.new("TextButton", mainSquare)
eggButton.Size = UDim2.new(0.8, 0, 0.15, 0)
eggButton.Position = UDim2.new(0.1, 0, 0.05, 0)
eggButton.Text = "Choose Egg"
eggButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
eggButton.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", eggButton)

local eggList = {"Bug Egg", "Night Egg", "Anti-Bee Egg", "Oasis Egg", "Paradise Egg"}
local dropdown = Instance.new("Frame", mainSquare)
dropdown.Size = UDim2.new(0.8, 0, 0.3, 0)
dropdown.Position = UDim2.new(0.1, 0, 0.2, 0)
dropdown.Visible = false
dropdown.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
Instance.new("UICorner", dropdown)

for i, egg in ipairs(eggList) do
    local btn = Instance.new("TextButton", dropdown)
    btn.Size = UDim2.new(1, 0, 0.2, 0)
    btn.Position = UDim2.new(0, 0, (i - 1) * 0.22, 0)
    btn.Text = egg
    btn.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
    btn.TextColor3 = Color3.new(1, 1, 1)
    Instance.new("UICorner", btn)

    btn.MouseButton1Click:Connect(function()
        selectedEgg = egg
        eggButton.Text = egg
        dropdown.Visible = false
    end)
end

eggButton.MouseButton1Click:Connect(function()
    dropdown.Visible = not dropdown.Visible
end)

-- Scanning Label
local function addScanningLabel(eggPart, petName, showName)
    local billboard = Instance.new("BillboardGui", eggPart)
    billboard.Size = UDim2.new(0, 120, 0, 50)
    billboard.Adornee = eggPart
    billboard.AlwaysOnTop = true

    local label = Instance.new("TextLabel", billboard)
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = showName and ("Scanning Pet: " .. petName) or "Scanning Pet"
    label.TextColor3 = Color3.new(1, 1, 0)
    label.Font = Enum.Font.GothamBold
    label.TextScaled = true

    table.insert(scannedEggs, {Part = eggPart, Billboard = billboard, PetName = petName})
end

-- Detect Button
local detectButton = Instance.new("TextButton", mainSquare)
detectButton.Size = UDim2.new(0.8, 0, 0.15, 0)
detectButton.Position = UDim2.new(0.1, 0, 0.6, 0)
detectButton.Text = "Detect Egg"
detectButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
detectButton.TextColor3 = Color3.new(1, 1, 1)
Instance.new("UICorner", detectButton)

-- Refresh Button
local refreshButton = Instance.new("TextButton", mainSquare)
refreshButton.Size = UDim2.new(0.8, 0, 0.15, 0)
refreshButton.Position = UDim2.new(0.1, 0, 0.78, 0)
refreshButton.Text = "Refresh"
refreshButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
refreshButton.TextColor3 = Color3.new(1, 1, 1)
refreshButton.AutoButtonColor = false
refreshButton.Active = false
Instance.new("UICorner", refreshButton)

detectButton.MouseButton1Click:Connect(function()
    if detectCooldown or not selectedEgg then return end
    detectCooldown = true
    refreshButton.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
    refreshButton.Active = false

    detectButton.Text = "Scanning..."
    for _, obj in ipairs(workspace:GetDescendants()) do
        if (obj:IsA("Model") or obj:IsA("Part")) and string.find(obj.Name:lower(), selectedEgg:lower()) then
            addScanningLabel(obj, petNames[selectedEgg] or "Unknown", false)
        end
    end

    local timeRemaining = 600
    task.spawn(function()
        while timeRemaining > 0 do
            task.wait(1)
            timeRemaining -= 1
            detectButton.Text = string.format("Scanning (%d:%02d)", math.floor(timeRemaining / 60), timeRemaining % 60)
        end
        detectCooldown = false
        detectButton.Text = "Detect Egg"
        refreshButton.BackgroundColor3 = Color3.fromRGB(70, 70, 70)
        refreshButton.Active = true
    end)
end)

refreshButton.MouseButton1Click:Connect(function()
    for _, data in ipairs(scannedEggs) do
        local label = data.Billboard:FindFirstChildOfClass("TextLabel")
        if label then
            label.Text = "Scanning Pet: " .. data.PetName
        end
    end
end)
