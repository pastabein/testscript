-- Place this full script in a LocalScript inside StarterGui

local player = game.Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")
local screenGui = Instance.new("ScreenGui", playerGui)
screenGui.ResetOnSpawn = false

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local SoundService = game:GetService("SoundService")

-- Draggable Utility
local function makeDraggable(frame)
    frame.Active = true
    frame.Draggable = true
end

-- Sound
local function playClickSound()
    local sound = Instance.new("Sound", SoundService)
    sound.SoundId = "rbxassetid://12222005"
    sound.Volume = 0.5
    sound:Play()
    game.Debris:AddItem(sound, 1)
end

-- Inactivity Auto-Close
local inactivityTime = 0
task.spawn(function()
    while true do
        task.wait(1)
        inactivityTime += 1
        if inactivityTime >= 300 then
            screenGui.Enabled = false
            break
        end
    end
end)
local function resetInactivity() inactivityTime = 0 end

-- Start Frame
local startFrame = Instance.new("Frame", screenGui)
startFrame.Size = UDim2.new(0, 250, 0, 120)
startFrame.Position = UDim2.new(0.4, 0, 0.4, 0)
startFrame.BackgroundColor3 = Color3.fromRGB(34, 70, 34)
Instance.new("UICorner", startFrame)
makeDraggable(startFrame)

local startButton = Instance.new("TextButton", startFrame)
startButton.Size = UDim2.new(0.7, 0, 0.5, 0)
startButton.Position = UDim2.new(0.15, 0, 0.25, 0)
startButton.Text = "Start"
Instance.new("UICorner", startButton)

-- Main GUI
local mainSquare = Instance.new("Frame", screenGui)
mainSquare.Size = UDim2.new(0, 280, 0, 280)
mainSquare.Position = UDim2.new(0.4, 0, 0.35, 0)
mainSquare.BackgroundColor3 = Color3.fromRGB(34, 70, 34)
mainSquare.Visible = false
Instance.new("UICorner", mainSquare)
makeDraggable(mainSquare)

startButton.MouseButton1Click:Connect(function()
    playClickSound()
    resetInactivity()
    startFrame.Visible = false
    mainSquare.Visible = true
end)

-- Minimize/Restore
local minimizeButton = Instance.new("TextButton", mainSquare)
minimizeButton.Size = UDim2.new(0, 25, 0, 25)
minimizeButton.Position = UDim2.new(1, -30, 0, 5)
minimizeButton.Text = "-"
Instance.new("UICorner", minimizeButton)

local minimizedCircle = Instance.new("TextButton", screenGui)
minimizedCircle.Size = UDim2.new(0, 50, 0, 50)
minimizedCircle.Position = UDim2.new(0.4, 0, 0.35, 0)
minimizedCircle.Text = "Full"
minimizedCircle.Visible = false
Instance.new("UICorner", minimizedCircle).CornerRadius = UDim.new(1, 0)
makeDraggable(minimizedCircle)

minimizeButton.MouseButton1Click:Connect(function()
    playClickSound()
    resetInactivity()
    mainSquare.Visible = false
    minimizedCircle.Visible = true
end)

minimizedCircle.MouseButton1Click:Connect(function()
    playClickSound()
    resetInactivity()
    minimizedCircle.Visible = false
    mainSquare.Visible = true
end)

-- Close Button
local closeButton = Instance.new("TextButton", mainSquare)
closeButton.Size = UDim2.new(0, 25, 0, 25)
closeButton.Position = UDim2.new(1, -60, 0, 5)
closeButton.Text = "X"
Instance.new("UICorner", closeButton)
closeButton.MouseButton1Click:Connect(function()
    playClickSound()
    screenGui.Enabled = false
end)

-- Reopen Hotkey
UserInputService.InputBegan:Connect(function(input, processed)
    if not processed and input.KeyCode == Enum.KeyCode.R then
        screenGui.Enabled = true
        mainSquare.Visible = true
        resetInactivity()
    end
end)

-- Egg Selection
local eggs = {"Bug Egg", "Night Egg", "Anti-Bee Egg", "Oasis Egg", "Paradise Egg"}
local eggColors = {
    ["Bug Egg"] = Color3.fromRGB(102, 204, 0),
    ["Night Egg"] = Color3.fromRGB(51, 51, 102),
    ["Anti-Bee Egg"] = Color3.fromRGB(204, 51, 0),
    ["Oasis Egg"] = Color3.fromRGB(51, 153, 204),
    ["Paradise Egg"] = Color3.fromRGB(255, 223, 0),
}
local petData = {
    ["Bug Egg"] = "Snail",
    ["Night Egg"] = "Moon Cat",
    ["Anti-Bee Egg"] = "Wasp",
    ["Oasis Egg"] = "Sand Snake",
    ["Paradise Egg"] = "Capybara",
}
local selectedEgg = "Bug Egg"

local eggButton = Instance.new("TextButton", mainSquare)
eggButton.Size = UDim2.new(0.8, 0, 0.15, 0)
eggButton.Position = UDim2.new(0.1, 0, 0.05, 0)
eggButton.Text = selectedEgg
eggButton.BackgroundColor3 = eggColors[selectedEgg]
Instance.new("UICorner", eggButton)

local petLabel = Instance.new("TextLabel", mainSquare)
petLabel.Size = UDim2.new(1, 0, 0.1, 0)
petLabel.Position = UDim2.new(0, 0, 0.58, 0)
petLabel.Text = "Pet: " .. petData[selectedEgg]
petLabel.BackgroundTransparency = 1

local eggListFrame = Instance.new("Frame", mainSquare)
eggListFrame.Size = UDim2.new(0.6, 0, 0.6, 0)
eggListFrame.Position = UDim2.new(1.05, 0, 0.05, 0)
eggListFrame.Visible = false
Instance.new("UICorner", eggListFrame)

for i, eggName in ipairs(eggs) do
    local eggOption = Instance.new("TextButton", eggListFrame)
    eggOption.Name = eggName
    eggOption.Size = UDim2.new(1, 0, 0.2, 0)
    eggOption.Position = UDim2.new(0, 0, (i - 1) * 0.22, 0)
    eggOption.Text = eggName
    eggOption.BackgroundColor3 = eggColors[eggName]
    Instance.new("UICorner", eggOption)

    eggOption.MouseButton1Click:Connect(function()
        playClickSound()
        resetInactivity()
        selectedEgg = eggName
        eggButton.Text = eggName
        eggButton.BackgroundColor3 = eggColors[eggName]
        petLabel.Text = "Pet: " .. (petData[eggName] or "Unknown")
        eggListFrame.Visible = false
    end)
end

eggButton.MouseButton1Click:Connect(function()
    playClickSound()
    resetInactivity()
    eggListFrame.Visible = not eggListFrame.Visible
end)

-- Refresh Button
local refreshButton = Instance.new("TextButton", mainSquare)
refreshButton.Size = UDim2.new(0.8, 0, 0.15, 0)
refreshButton.Position = UDim2.new(0.1, 0, 0.25, 0)
refreshButton.Text = "Refresh"
Instance.new("UICorner", refreshButton)

local refreshTimer
refreshButton.MouseButton1Click:Connect(function()
    playClickSound()
    resetInactivity()
    if refreshTimer then
        refreshButton.Text = "Cooldown!"
        task.wait(1)
        refreshButton.Text = "Refresh"
        return
    end
    refreshTimer = true
    local timeRemaining = 180
    task.spawn(function()
        while timeRemaining > 0 do
            task.wait(1)
            timeRemaining -= 1
            refreshButton.Text = string.format("Refresh (%d:%02d)", math.floor(timeRemaining / 60), timeRemaining % 60)
        end
        refreshButton.Text = "Refresh"
        refreshTimer = nil
    end)
end)

-- Detect Egg Button
local detectButton = Instance.new("TextButton", mainSquare)
detectButton.Size = UDim2.new(0.8, 0, 0.15, 0)
detectButton.Position = UDim2.new(0.1, 0, 0.45, 0)
detectButton.Text = "Detect Egg"
detectButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
Instance.new("UICorner", detectButton)

local function scanForEggs()
    local foundEggs = {}
    for _, obj in ipairs(workspace:GetDescendants()) do
        if obj:IsA("Model") or obj:IsA("Part") then
            if string.find(obj.Name:lower(), "egg") then
                table.insert(foundEggs, obj.Name)
            end
        end
    end
    return #foundEggs > 0 and table.concat(foundEggs, ", ") or "No eggs found"
end

detectButton.MouseButton1Click:Connect(function()
    playClickSound()
    resetInactivity()
    detectButton.Text = "Scanning..."
    local eggsFound = scanForEggs()
    detectButton.Text = "Found: " .. eggsFound
    task.delay(4, function()
        detectButton.Text = "Detect Egg"
    end)
end)

-- Title
local titleLabel = Instance.new("TextLabel", mainSquare)
titleLabel.Size = UDim2.new(1, 0, 0.1, 0)
titleLabel.Position = UDim2.new(0, 0, 0.7, 0)
titleLabel.Text = "Egg Refresher - Real Scan"
titleLabel.BackgroundTransparency = 1
